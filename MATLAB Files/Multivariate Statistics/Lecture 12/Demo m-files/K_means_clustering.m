clear;close all;clc;
format compact

disp('----------------------------------------------------------------------')
X = [1.1 9.1; 2.1 8.7; 1.5 7.9; 2.1 7.5; 0.5 6.8; 4.5 8.3; 2.9 9.2; 0.5 0.9; 1.1 1.3; 0.6 2; 1.7 0.5; 2.5 6.5; 2.4 4.7; 3.1 5.4; 3.8 3.5; 3 3; 4 4.5; 7.1 4; 7.5 3.2; 8.8 3.9]
[n p] = size(X)

figure
subplot(6,4,1:4)
axis off
text(0,1.2,'Non-hierarchical "K-means" clustering example:','Fontsize',24)
text(0,0.85,'n=20 observations, p=2 variables, K=2,3,4,5 clusters','Fontsize',18)
text(0,0.55,'SSW minimized over 10 initial clusterings pr. K-value','Fontsize',16)
text(0.65,1.2,'Silhouette value pr. obs  j = 1,...,n','Fontsize',12)
text(0.65,0.9,'h_s_,_j = (d_a_v_e_r_,_n_e_x_t_ _c_l_u_s_t_e_r - d_a_v_e_r_,_o_w_n_ _c_l_u_s_t_e_r) / max(these 2 numbers)','Fontsize',12)
text(0.65,0.55,'=>  -1 < h_s_,_j < 1','Fontsize',12)

disp('---------------------------------------------------------------------')
subplot(6,4,[5 9])
K = 2;
[idx2, C, sumd] = kmeans(X,K,'distance','sqEuclidean','start','sample','replicates',10);
idx2_cluster_1 = (find(idx2 == 1))'
idx2_cluster_2 = (find(idx2 == 2))'
plot(X(:,1),X(:,2),'ro','LineWidth',3),xlim([0 10]),ylim([0 10]),grid,axis square,xlabel('x_1','Fontsize',12),ylabel('x_2','Fontsize',12)
title(['(SSW = ' num2str(sum(sumd),3) ')'],'Fontsize',14)
text(10.5,11.5,'K = 2','Fontsize',28)
hold on
for j = 1:n
    text(X(j,1)+0.3,X(j,2),num2str(j),'Fontsize',12)
end
annotation('ellipse',...
    [0.144375 0.678571428571428 0.066875 0.102040816326526],'LineStyle','--',...
    'LineWidth',2,...
    'Color',[0 1 0]);
annotation('ellipse',...
    [0.137875 0.522959183673469 0.1265 0.160714285714277],'LineStyle','--',...
    'LineWidth',2,...
    'Color',[0 1 0]);
hold off
subplot(6,4,[6 10])
[silh h] = silhouette(X,idx2);title(['mean(silhouette) = ' num2str(mean(silh),3)],'Fontsize',14)

disp('---------------------------------------------------------------------')
subplot(6,4,[7 11])
K = 3;
[idx3, C, sumd] = kmeans(X,K,'distance','sqEuclidean','start','sample','replicates',10);
idx3_cluster_1 = (find(idx3 == 1))'
idx3_cluster_2 = (find(idx3 == 2))'
idx3_cluster_3 = (find(idx3 == 3))'
plot(X(:,1),X(:,2),'ro','LineWidth',3),xlim([0 10]),ylim([0 10]),grid,axis square,xlabel('x_1','Fontsize',12),ylabel('x_2','Fontsize',12)
title(['(SSW = ' num2str(sum(sumd),3) ')'],'Fontsize',14)
text(10.5,11.5,'K = 3','Fontsize',28)
hold on
for j = 1:n
    text(X(j,1)+0.3,X(j,2),num2str(j),'Fontsize',12)
end
annotation('ellipse',...
    [0.554375000000002 0.661989795918367 0.0762499999999984 0.119897959183673],...
    'LineStyle','--',...
    'LineWidth',2,...
    'Color',[0 1 0]);
annotation('ellipse',...
    [0.554375000000001 0.530612244897959 0.0768749999999992 0.13051020408163],...
    'LineStyle','--',...
    'LineWidth',2,...
    'Color',[0 1 0]);
annotation('ellipse',...
    [0.6375 0.591836734693878 0.040625 0.0676020408163265],'LineStyle','--',...
    'LineWidth',2,...
    'Color',[0 1 0]);
hold off
subplot(6,4,[8 12])
[silh h] = silhouette(X,idx3);title(['mean(silhouette) = ' num2str(mean(silh),3)],'Fontsize',14)

disp('---------------------------------------------------------------------')
subplot(6,4,[17 21])
K = 4;
[idx4, C, sumd] = kmeans(X,K,'distance','sqEuclidean','start','sample','replicates',10);
idx4_cluster_1 = (find(idx4 == 1))'
idx4_cluster_2 = (find(idx4 == 2))'
idx4_cluster_3 = (find(idx4 == 3))'
idx4_cluster_4 = (find(idx4 == 4))'
plot(X(:,1),X(:,2),'ro','LineWidth',3),xlim([0 10]),ylim([0 10]),grid,axis square,xlabel('x_1','Fontsize',12),ylabel('x_2','Fontsize',12)
title(['(SSW = ' num2str(sum(sumd),3) ')'],'Fontsize',14)
text(10.5,11.5,'K = 4','Fontsize',28)
hold on
for j = 1:n
    text(X(j,1)+0.3,X(j,2),num2str(j),'Fontsize',12)
end
annotation('ellipse',...
    [0.1425 0.255918367346936 0.069375 0.0965306122449002],'LineStyle','--',...
    'LineWidth',2,...
    'Color',[0 1 0]);
annotation('ellipse',...
    [0.17 0.162397959183671 0.05 0.0965306122449002],'LineStyle','--',...
    'LineWidth',2,...
    'Color',[0 1 0]);
annotation('ellipse',...
    [0.142500000000002 0.103724489795917 0.0431249999999977 0.0761224489795933],...
    'LineStyle','--',...
    'LineWidth',2,...
    'Color',[0 1 0]);
annotation('ellipse',...
    [0.22375 0.165816326530612 0.03875 0.0731122448979586],'LineStyle','--',...
    'LineWidth',2,...
    'Color',[0 1 0]);
hold off
subplot(6,4,[18 22])
[silh h] = silhouette(X,idx4);title(['mean(silhouette) = ' num2str(mean(silh),3)],'Fontsize',14)

disp('---------------------------------------------------------------------')
subplot(6,4,[19 23])
K = 5;
[idx5, C, sumd] = kmeans(X,K,'distance','sqEuclidean','start','sample','replicates',10);
idx5_cluster_1 = (find(idx5 == 1))'
idx5_cluster_2 = (find(idx5 == 2))'
idx5_cluster_3 = (find(idx5 == 3))'
idx5_cluster_4 = (find(idx5 == 4))'
idx5_cluster_5 = (find(idx5 == 5))'
plot(X(:,1),X(:,2),'ro','LineWidth',3),xlim([0 10]),ylim([0 10]),grid,axis square,xlabel('x_1','Fontsize',12),ylabel('x_2','Fontsize',12)
title(['(SSW = ' num2str(sum(sumd),3) ')'],'Fontsize',14)
text(10.5,11.5,'K = 5','Fontsize',28)
hold on
for j = 1:n
    text(X(j,1)+0.3,X(j,2),num2str(j),'Fontsize',12)
end
hold off
annotation('ellipse',...
    [0.590625000000003 0.303571428571428 0.0387499999999974 0.0573979591836739],...
    'LineStyle','--',...
    'LineWidth',2,...
    'Color',[0 1 0]);
annotation('ellipse',...
    [0.554375000000003 0.244438775510201 0.0424999999999971 0.0961224489795945],...
    'LineStyle','--',...
    'LineWidth',2,...
    'Color',[0 1 0]);
annotation('ellipse',...
    [0.581875 0.16535714285714 0.05 0.0965306122449002],'LineStyle','--',...
    'LineWidth',2,...
    'Color',[0 1 0]);
annotation('ellipse',...
    [0.638750000000001 0.166224489795918 0.03875 0.0731122448979586],...
    'LineStyle','--',...
    'LineWidth',2,...
    'Color',[0 1 0]);
annotation('ellipse',...
    [0.559375000000002 0.102857142857141 0.0431249999999977 0.0761224489795933],...
    'LineStyle','--',...
    'LineWidth',2,...
    'Color',[0 1 0]);
subplot(6,4,[20 24])
[silh h] = silhouette(X,idx5);title(['mean(silhouette) = ' num2str(mean(silh),3)],'Fontsize',14)
disp('----------------------------------------------------------------------')

%---------------------------------------------------------------------------------------------------------------------------------
