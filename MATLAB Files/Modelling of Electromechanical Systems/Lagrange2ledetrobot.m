syms m1 g lc1 m2 l1 lc2  Il1 Il2 t tau1 tau2 real;
syms q1(t) q2(t)
syms ddq1 ddq2 real;
dq1 = diff(q1,t);
dq2 = diff(q2,t);
Epot = m1*g*lc1*sin(q1)+m2*g*(l1*sin(q1)+lc2*sin(q1+q2));
Ekin = 1/2*[dq1 dq2]*[m1*lc1^2+Il1+m2*(l1^2+lc2^2+2*l1*lc2*cos(q2))+Il2 m2*(lc2^2+l1*lc2*cos(q2)+Il2);m2*(lc2^2+l1*lc2*cos(q2))+Il2 m2*lc2^2+Il2]*[dq1;dq2];

L = Ekin-Epot;

term1a = diff(L, dq1(t));
term1dif = diff(term1a, t);
term1b = diff(L, q1);

eq1 = term1dif-term1b == tau1;

term2a = diff(L, dq2(t));
term2dif = diff(term2a, t);
term2b = diff(L, q2);

eq2 = term2dif-term2b == tau2;

isolate(eq1,diff(q1,t,t));
isolate(eq2,diff(q2,t,t));

eq1a = diff(q1(t), t, t) == -(((Il2 + m2*(lc2^2 + l1*cos(q2(t))*lc2))*-((Il2/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2))/2)*diff(q1(t), t, t) - tau2 + diff(q1(t), t)*(l1*lc2*m2*sin(q2(t))*diff(q1(t), t) + (l1*lc2*m2*sin(q2(t))*diff(q2(t), t))/2) + (m2*diff(q1(t), t, t)*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/2 + g*lc2*m2*cos(q1(t) + q2(t)) - (l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/2)/(m2*lc2^2 + Il2))/2 - tau1 + (m2*-((Il2/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2))/2)*diff(q1(t), t, t) - tau2 + diff(q1(t), t)*(l1*lc2*m2*sin(q2(t))*diff(q1(t), t) + (l1*lc2*m2*sin(q2(t))*diff(q2(t), t))/2) + (m2*diff(q1(t), t, t)*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/2 + g*lc2*m2*cos(q1(t) + q2(t)) - (l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/2)/(m2*lc2^2 + Il2)*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/2 + g*m2*(l1*cos(q1(t)) + lc2*cos(q1(t) + q2(t))) + g*lc1*m1*cos(q1(t)) - l1*lc2*m2*sin(q2(t))*diff(q2(t), t)^2 - 2*l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/(Il1 + Il2 + m2*(l1^2 + 2*cos(q2(t))*l1*lc2 + lc2^2) + lc1^2*m1);
eq2a = diff(q2(t), t, t) == -((Il2/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2))/2)*(((Il2 + m2*(lc2^2 + l1*cos(q2(t))*lc2))*(tau2 - diff(q1(t), t)*(l1*lc2*m2*sin(q2(t))*diff(q1(t), t) + (l1*lc2*m2*sin(q2(t))*diff(q2(t), t))/2) - g*lc2*m2*cos(q1(t) + q2(t)) + (l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/2))/(2*(m2*lc2^2 + Il2)) - tau1 + g*m2*(l1*cos(q1(t)) + lc2*cos(q1(t) + q2(t))) + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2)*(tau2 - diff(q1(t), t)*(l1*lc2*m2*sin(q2(t))*diff(q1(t), t) + (l1*lc2*m2*sin(q2(t))*diff(q2(t), t))/2) - g*lc2*m2*cos(q1(t) + q2(t)) + (l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/2))/(2*(m2*lc2^2 + Il2)) + g*lc1*m1*cos(q1(t)) - l1*lc2*m2*sin(q2(t))*diff(q2(t), t)^2 - 2*l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/(((((Il2 + m2*(lc2^2 + l1*cos(q2(t))*lc2))*(Il2/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2))/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/2))/(2*(m2*lc2^2 + Il2)) + (m2*(Il2/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2))/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/2)*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/(2*(m2*lc2^2 + Il2)))/(Il1 + Il2 + m2*(l1^2 + 2*cos(q2(t))*l1*lc2 + lc2^2) + lc1^2*m1) - 1)*(Il1 + Il2 + m2*(l1^2 + 2*cos(q2(t))*l1*lc2 + lc2^2) + lc1^2*m1)) - tau2 + diff(q1(t), t)*(l1*lc2*m2*sin(q2(t))*diff(q1(t), t) + (l1*lc2*m2*sin(q2(t))*diff(q2(t), t))/2) + (m2*(((Il2 + m2*(lc2^2 + l1*cos(q2(t))*lc2))*(tau2 - diff(q1(t), t)*(l1*lc2*m2*sin(q2(t))*diff(q1(t), t) + (l1*lc2*m2*sin(q2(t))*diff(q2(t), t))/2) - g*lc2*m2*cos(q1(t) + q2(t)) + (l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/2))/(2*(m2*lc2^2 + Il2)) - tau1 + g*m2*(l1*cos(q1(t)) + lc2*cos(q1(t) + q2(t))) + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2)*(tau2 - diff(q1(t), t)*(l1*lc2*m2*sin(q2(t))*diff(q1(t), t) + (l1*lc2*m2*sin(q2(t))*diff(q2(t), t))/2) - g*lc2*m2*cos(q1(t) + q2(t)) + (l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/2))/(2*(m2*lc2^2 + Il2)) + g*lc1*m1*cos(q1(t)) - l1*lc2*m2*sin(q2(t))*diff(q2(t), t)^2 - 2*l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/(((((Il2 + m2*(lc2^2 + l1*cos(q2(t))*lc2))*(Il2/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2))/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/2))/(2*(m2*lc2^2 + Il2)) + (m2*(Il2/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2))/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/2)*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/(2*(m2*lc2^2 + Il2)))/(Il1 + Il2 + m2*(l1^2 + 2*cos(q2(t))*l1*lc2 + lc2^2) + lc1^2*m1) - 1)*(Il1 + Il2 + m2*(l1^2 + 2*cos(q2(t))*l1*lc2 + lc2^2) + lc1^2*m1))*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/2 + g*lc2*m2*cos(q1(t) + q2(t)) - (l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/2)/(m2*lc2^2 + Il2);

isolate(eq1a,diff(q1,t,t))
eq1b = diff(q1(t), t, t) == (((Il2 + m2*(lc2^2 + l1*cos(q2(t))*lc2))*(tau2 - diff(q1(t), t)*(l1*lc2*m2*sin(q2(t))*diff(q1(t), t) + (l1*lc2*m2*sin(q2(t))*diff(q2(t), t))/2) - g*lc2*m2*cos(q1(t) + q2(t)) + (l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/2))/(2*(m2*lc2^2 + Il2)) - tau1 + g*m2*(l1*cos(q1(t)) + lc2*cos(q1(t) + q2(t))) + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2)*(tau2 - diff(q1(t), t)*(l1*lc2*m2*sin(q2(t))*diff(q1(t), t) + (l1*lc2*m2*sin(q2(t))*diff(q2(t), t))/2) - g*lc2*m2*cos(q1(t) + q2(t)) + (l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/2))/(2*(m2*lc2^2 + Il2)) + g*lc1*m1*cos(q1(t)) - l1*lc2*m2*sin(q2(t))*diff(q2(t), t)^2 - 2*l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/(((((Il2 + m2*(lc2^2 + l1*cos(q2(t))*lc2))*(Il2/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2))/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/2))/(2*(m2*lc2^2 + Il2)) + (m2*(Il2/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2))/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/2)*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/(2*(m2*lc2^2 + Il2)))/(Il1 + Il2 + m2*(l1^2 + 2*cos(q2(t))*l1*lc2 + lc2^2) + lc1^2*m1) - 1)*(Il1 + Il2 + m2*(l1^2 + 2*cos(q2(t))*l1*lc2 + lc2^2) + lc1^2*m1));
isolate(eq2a,diff(q2,t,t))
eq2b = diff(q2(t), t, t) == -(diff(q1(t), t)*(l1*lc2*m2*sin(q2(t))*diff(q1(t), t) + (l1*lc2*m2*sin(q2(t))*diff(q2(t), t))/2) - tau2 + g*lc2*m2*cos(q1(t) + q2(t)) + ((Il2/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2))/2)*(((Il2 + m2*(lc2^2 + l1*cos(q2(t))*lc2))*(tau2 - diff(q1(t), t)*(l1*lc2*m2*sin(q2(t))*diff(q1(t), t) + (l1*lc2*m2*sin(q2(t))*diff(q2(t), t))/2) - g*lc2*m2*cos(q1(t) + q2(t)) + (l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/2))/(2*m2*lc2^2 + 2*Il2) - tau1 + g*m2*(l1*cos(q1(t)) + lc2*cos(q1(t) + q2(t))) + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2)*(tau2 - diff(q1(t), t)*(l1*lc2*m2*sin(q2(t))*diff(q1(t), t) + (l1*lc2*m2*sin(q2(t))*diff(q2(t), t))/2) - g*lc2*m2*cos(q1(t) + q2(t)) + (l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/2))/(2*m2*lc2^2 + 2*Il2) + g*lc1*m1*cos(q1(t)) - l1*lc2*m2*sin(q2(t))*diff(q2(t), t)^2 - 2*l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t)))/(((((Il2 + m2*(lc2^2 + l1*cos(q2(t))*lc2))*(Il2/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2))/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/2))/(2*m2*lc2^2 + 2*Il2) + (m2*(Il2/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2))/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/2)*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/(2*m2*lc2^2 + 2*Il2))/(Il1 + Il2 + m2*(l1^2 + 2*cos(q2(t))*l1*lc2 + lc2^2) + lc1^2*m1) - 1)*(Il1 + Il2 + m2*(l1^2 + 2*cos(q2(t))*l1*lc2 + lc2^2) + lc1^2*m1)) + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2)*(((Il2 + m2*(lc2^2 + l1*cos(q2(t))*lc2))*(tau2 - diff(q1(t), t)*(l1*lc2*m2*sin(q2(t))*diff(q1(t), t) + (l1*lc2*m2*sin(q2(t))*diff(q2(t), t))/2) - g*lc2*m2*cos(q1(t) + q2(t)) + (l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/2))/(2*m2*lc2^2 + 2*Il2) - tau1 + g*m2*(l1*cos(q1(t)) + lc2*cos(q1(t) + q2(t))) + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2)*(tau2 - diff(q1(t), t)*(l1*lc2*m2*sin(q2(t))*diff(q1(t), t) + (l1*lc2*m2*sin(q2(t))*diff(q2(t), t))/2) - g*lc2*m2*cos(q1(t) + q2(t)) + (l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/2))/(2*m2*lc2^2 + 2*Il2) + g*lc1*m1*cos(q1(t)) - l1*lc2*m2*sin(q2(t))*diff(q2(t), t)^2 - 2*l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t)))/(2*((((Il2 + m2*(lc2^2 + l1*cos(q2(t))*lc2))*(Il2/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2))/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/2))/(2*m2*lc2^2 + 2*Il2) + (m2*(Il2/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2))/2 + (m2*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/2)*(lc2^2 + l1*cos(q2(t))*lc2 + Il2))/(2*m2*lc2^2 + 2*Il2))/(Il1 + Il2 + m2*(l1^2 + 2*cos(q2(t))*l1*lc2 + lc2^2) + lc1^2*m1) - 1)*(Il1 + Il2 + m2*(l1^2 + 2*cos(q2(t))*l1*lc2 + lc2^2) + lc1^2*m1)) - (l1*lc2*m2*sin(q2(t))*diff(q1(t), t)*diff(q2(t), t))/2)/(m2*lc2^2 + Il2);
